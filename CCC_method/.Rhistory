}
} else {model <- models
for (i in ny) {
modelli[[i]] <- building(X1Y, ny = i, model = model)
}
}
modelli
model.building <- function(X1Y, ny = c(1,3,4,5,7,8,9), models = NULL) {
modelli <- list(length=length(ny))
if (is.null(models)) {
for (i in ny) {
if (i == 1 || 4 || 5 || 8 || 9 ) {model <- "logistic"
modelli[[i]] <- building(X1Y, ny = i, model = model)
}
if (i == 3) {model <- "pls"
modelli[[i]] <- building(X1Y, ny = i, model = model)
}
if (i == 7) {model <- "lasso"
modelli[[i]] <- building(X1Y, ny = i, model = model)
}
}
} else {model <- models
for (i in ny) {
modelli[[i]] <- building(X1Y, ny = i, model = model)
}
}
return(modelli)
}
models <- model.building(X1Y, ny, models)
models
i
ny
ny = c(1,3,4,5,7,8,9)
models = NULL
modelli <- list(length=length(ny))
if (is.null(models)) {
for (i in ny) {
if (i == 1 || 4 || 5 || 8 || 9 ) {model <- "logistic"
modelli[[i]] <- building(X1Y, ny = i, model = model)
}
if (i == 3) {model <- "pls"
modelli[[i]] <- building(X1Y, ny = i, model = model)
}
if (i == 7) {model <- "lasso"
modelli[[i]] <- building(X1Y, ny = i, model = model)
}
}
} else {model <- models
for (i in ny) {
modelli[[i]] <- building(X1Y, ny = i, model = model)
}
}
modelli <- list(length=length(ny))
if (is.null(models)) {
for (i in ny) {
if (i == 1) {model <- "logistic"
modelli[[i]] <- building(X1Y, ny = i, model = model)
}
if (i == 4) {model <- "logistic"
modelli[[i]] <- building(X1Y, ny = i, model = model)
}
if (i == 5) {model <- "logistic"
modelli[[i]] <- building(X1Y, ny = i, model = model)
}
if (i == 8) {model <- "logistic"
modelli[[i]] <- building(X1Y, ny = i, model = model)
}
if (i == 9) {model <- "logistic"
modelli[[i]] <- building(X1Y, ny = i, model = model)
}
if (i == 3) {model <- "pls"
modelli[[i]] <- building(X1Y, ny = i, model = model)
}
if (i == 7) {model <- "lasso"
modelli[[i]] <- building(X1Y, ny = i, model = model)
}
}
} else {model <- models
for (i in ny) {
modelli[[i]] <- building(X1Y, ny = i, model = model)
}
}
library(CCC)
data(STD_RP)
X1Y <- dataset.building(STD_RP)
models <- model.building(X1Y, ny, models)
library("CCC", lib.loc="~/R/win-library/3.2")
data(STD_RP)
X1Y <- dataset.building(STD_RP)
models <- model.building(X1Y, ny, models)
STD_RP <- read.csv(system.file("extdata", "STD_RP.csv", package = "CCC"), row.names = 1, stringsAsFactors = F)
X1Y <- dataset.building(STD_RP)
models <- model.building(X1Y, ny, models)
STD_RP <- read.csv(system.file("extdata", "STD_RP.csv", package = "CCC"), row.names = 1, stringsAsFactors = F)
X1Y <- dataset.building(STD_RP)
models <- model.building(X1Y, ny = c(1,3,4,5,7,8,9), models)
model.building <- function(X1Y, ny = c(1,3,4,5,7,8,9), models = NULL) {
modelli <- list(length=length(ny))
if (is.null(models)) {
for (i in ny) {
if (i == 1) {model <- "logistic"
modelli[[i]] <- building(X1Y, ny = i, model = model)
}
if (i == 4) {model <- "logistic"
modelli[[i]] <- building(X1Y, ny = i, model = model)
}
if (i == 5) {model <- "logistic"
modelli[[i]] <- building(X1Y, ny = i, model = model)
}
if (i == 8) {model <- "logistic"
modelli[[i]] <- building(X1Y, ny = i, model = model)
}
if (i == 9) {model <- "logistic"
modelli[[i]] <- building(X1Y, ny = i, model = model)
}
if (i == 3) {model <- "pls"
modelli[[i]] <- building(X1Y, ny = i, model = model)
}
if (i == 7) {model <- "lasso"
modelli[[i]] <- building(X1Y, ny = i, model = model)
}
}
} else {model <- models
for (i in ny) {
modelli[[i]] <- building(X1Y, ny = i, model = model)
}
}
return(modelli)
}
models <- model.building(X1Y, ny = c(1,3,4,5,7,8,9))
models <- model.building(X1Y, ny = c(1,3,4,5,7,8,9))
models[[1]]
models[[2]]
models[[4]]
models <- model.building(X1Y)
STD_NP <- read.csv(system.file("extdata", "STD_NP.csv", package = "CCC"), row.names = 1, stringsAsFactors = F) X1Y <- dataset.building(STD_NP)
models <- model.building(X1Y)
STD_NP <- read.csv(system.file("extdata", "STD_NP.csv", package = "CCC"), stringsAsFactors = F)
X1Y <- dataset.building(STD_NP)
models <- model.building(X1Y)
library(CCC)
STD_NP <- read.csv(system.file("extdata", "STD_NP.csv", package = "CCC"), stringsAsFactors = F)
X1Y <- dataset.building(STD_NP)
models <- model.building(X1Y)
data("peakTable")
tni <- apply.model(peakTable, polarity = "negative", models <- models)
tni[[1]]
library(CCC)
remove.packages("metfRag")
remove.packages("metfRag", library = .libPath[2])
.libPaths[2]
.libPaths
.libPaths()
.libPaths()[2]
remove.packages("metfRag", library = .libPaths()[2])
remove.packages(metfRag library = .libPaths()[2])
remove.packages(metfRag, library = .libPaths()[2])
remove.packages(metfRag)
.libPaths() <- libPaths()[2]
.libPaths() <- .libPaths()[2]
.libPaths()[1] <- .libPaths()[2]
.libPaths()
update.packages(metfRag)
update.packages("metfRag")
library(devtools)
install_github("c-ruttkies/MetFragR/metfRag")
library(metfRag)
library(devtools)
install_github("c-ruttkies/MetFragR/metfRag", force = TRUE)
library(metfRag)
library("metfRag", lib.loc="C:/Program Files/R/R-3.2.2/library")
detach("package:metfRag", unload=TRUE)
library("CCC", lib.loc="~/R/win-library/3.2")
detach("package:CCC", unload=TRUE)
library("metfRag", lib.loc="C:/Program Files/R/R-3.2.2/library")
detach("package:metfRag", unload=TRUE)
remove.packages("metfRag", lib="C:/Program Files/R/R-3.2.2/library")
.libPaths()
R_LIBS= C:/Program Files/R/R-3.2.2/library
R_LIBS= "C:/Program Files/R/R-3.2.2/library"
R_LIBS= C:/Program Files/R/R-3.2.2/library
R_LIBS= C:\Program Files\R\-3.2.2\library
R.home()
R.home(.libPaths(.libPaths()[2]))
R.home(.libPaths(.libPaths()[2]))
R_LIBS
Sys.getenv("R_LIBS_USER")
.libPaths()
Sys.getenv("R_LIBS_USER") <- "C:/Program Files/R/R-3.2.2/library"
Sys.getenv()
Sys.getenv("R_LIBS_USER")
?Sys.getenv
.libPaths()
Sys.setenv("R_LIBS_USER", "C:/Program Files/R/R-3.2.2/library")
Sys.setenv("R_LIBS_USER")
Sys.setenv("R_LIBS_USER", "C:/Program Files/R/R-3.2.2/library")
ah <- "C:/Program Files/R/R-3.2.2/library"
Sys.setenv("R_LIBS_USER", ah)
Sys.getenv()
library(CCC)
library("CCC", lib.loc="C:/Program Files/R/R-3.3.0/library")
detach("package:CCC", unload=TRUE)
library("devtools", lib.loc="C:/Program Files/R/R-3.3.0/library")
remove.packages("metfRag")
install_github("c-ruttkies/MetFragR/metfRag", args="--no-multiarch")
data(peakTable)
library("CCC", lib.loc="C:/Program Files/R/R-3.3.0/library")
tni <- apply.model(peakTable, polarity = "negative")
ps_spectra <- ps_spec(tni, peakTable)
get.low.var <- function(peakTable){
require(modeest)
threshold <- 1000
colli <- str_sub(colnames(peakTable), start = 6L, end = 11L)
collis <- str_detect(colli, pattern="_S")
coll <- colli[collis]
coll <- str_replace(coll, pattern = "_", replacement = ".")
pea <- peakTable[, collis]
pee <- peakTable[,1:8]
peaktaba <- apply(pea, 1, function(x) max(x))
thre <- which(peaktaba >= threshold)
pea <- pea[thre,]
pee <- pee[thre,]
colnames(pea) <- coll
ac <- apply(pea, 2, mean)
incl <- which(ac >= quantile(ac, prob=0.05))
pea <- pea[,incl]
vari <- apply(pea, 1, var)
devst <- sqrt(vari)
maxi <- apply(pea, 1, function(x) max(x))
meani <- apply(pea, 1, mean)
medi <- apply(pea, 1, median)
nonp_skew <- (medi-meani)/devst
moda <- apply(pea, 1, mlv,  method = "mfv")
modas <- sapply(rep(1:length(moda)), function(i) drop(moda[[i]][[1]]))
skew <- sapply(rep(1:length(moda)), function(i) drop(moda[[i]][[2]]))
quan <- apply(pea, 1, function(x) quantile(x, prob = c(0.1, 0.9)))
quani <- quan[2,] - quan[1,]
ratio <- quani/maxi
var.coef <- devst/meani
peaktab <- cbind(pee, pea, devst, ratio, nonp_skew, modas, skew, var.coef)
selection <- peaktab[peaktab$modas >= 500 & peaktab$ratio >= 0.3 & peaktab$skew >= -0.5 & peaktab$var.coef <= 0.5 & peaktab$skew <=0.5,]
write.csv(selection, file="peaktab_RPneg.csv")
spectras = list()
for (i in c(as.factor(selection$pcgroup))) {
mzs <- peakTable[peakTable$pcgroup == i, "mz"]
int <- rowSums(peakTable[peakTable$pcgroup == i, 9:(ncol(peakTable))])
spectra <- cbind(mzs, int, i)
spectras[[i]] <- spectra
}
spectras <- do.call(rbind, spectras)
write.csv(spectras, file= "spectras_RPneg.csv")
markers <- row.names(selection)
return(markers)
}
ab <- get.low.var(peakTable = )
ab <- get.low.var(peakTable)
require(chemhelper)
require(stringr)
peakTable <- metaMS.set$PeakTable
ord <- order(peakTable$mz)
peakTable <- peakTable[ord,]
row.names(peakTable) <- 1: nrow(peakTable)
STD_RP <- read.csv("H:/R/STD_RP.csv", stringsAsFactors=FALSE)
load("H:/R/R stuff/short_rts.Rdata")
mzs <- as.numeric(STD_RP$MM + 1.0078)
RTS <- as.numeric(STD_RP$RT)
lo <- RTS
RT.est <- RT.est <- predict(shrts, newdata = data.frame(lo), interval = c("confidence"), level = 0.95)
RTS <- as.numeric(RT.est[,1])
nam <- db.comp.assign(mz = as.numeric(peakTable$mz),rt = as.numeric(peakTable$rt),
comp_name_db = STD_RP$compound, mz_db = mzs, rt_db = RTS, mzabs=0.01,ppm=20,ret_tol=1.5)
peakTable <- cbind(nam, peakTable)
sicuri <- intersect(peakTable$nam, peakTable$compound)
remove.packages("mzR")
source("https://bioconductor.org/biocLite.R")
biocLite("mzR")
source("https://bioconductor.org/biocLite.R")
biocLite("mzR")
remove.packages("BiocInstaller")
bin.model.CO <- load(system.file("extdata", "bin.model.acid.rda", package = "CCC"))
library(CCC)
bin.model.CO <- load(system.file("extdata", "bin.model.acid.rda", package = "CCC"))
load(system.file("extdata", "bin.model.acid.rda", package = "CCC"))
load(system.file("extdata", "bin.model.acid.rda", package = "CCC"))
load(system.file("extdata","bin.model.NN.rda", package ="CCC"))
load(system.file("extdata","bin.model.SS.rda", package ="CCC"))
load(system.file("extdata","bin.model.bs.rda", package ="CCC"))
load(system.file("extdata","bin.model.CO.rda", package ="CCC"))
load(system.file("extdata","lasso.md.CO.rda", package ="CCC"))
load(system.file("extdata","lasso.md.aliph.rda", package ="CCC"))
load(system.file("extdata","pls.md.SS.rda", package ="CCC"))
load(system.file("extdata","pls.md.phenolics.rda", package ="CCC"))
library(CCC)
data(peakTable)
tni <- apply.model(peakTable, polarity = "negative")
library(CCC)
data(peakTable)
tni <- apply.model(peakTable, polarity = "negative")
tni[[1]]
View(peakTable)
which(!is.null(peakTable$ChemSpiderID))
which(!is.null(peakTable$compound))
ord <- order(peakTable$compound)
peakTable <- (peakTable[ord,])
ord <- order(-peakTable$compound)
ord <- order(peakTable[[-"compound"]])
ord <- order(peakTable[["compound"]])
peakTable <- (peakTable[-ord,])
data(peakTable)
write.csv(peakTable, file = "peakTable.csv")
library(CCC)
short <- 60
max(short <= 30)
max(short) <= 30
data(peakTable)
if (str_detect(tail(colnames(peakTable), n = 1L), coll("RP")) & (max(peakTable$rt) <= 30))
{
load(system.file("extdata", "rts.lm.rda", package = "CCC"))
}
if (str_detect(tail(colnames(peakTable), n = 1L), coll("RP")) & (max(short) <= 30)) {load(system.file("extdata", "rts.lm.rda", package = "CCC"))}
if (str_detect(tail(colnames(peakTable), n = 1L), coll("RP")) & (max(short) <= 30)) {load(system.file("extdata", "rts.lm.rda", package = "CCC"))}
short = 20
if (str_detect(tail(colnames(peakTable), n = 1L), coll("RP")) & (max(short) <= 30)) {load(system.file("extdata", "rts.lm.rda", package = "CCC"))}
str_detect(tail(colnames(peakTable), n = 1L), coll("RP"))
data(peakTable)
require(chemhelper)
require(stringr)
peakTable <- metaMS.set$PeakTable
ord <- order(peakTable$mz)
peakTable <- peakTable[ord,]
row.names(peakTable) <- 1: nrow(peakTable)
STD_RP <- read.csv("H:/R/STD_RP.csv", stringsAsFactors=FALSE)
load("H:/R/R stuff/short_rts.Rdata")
mzs <- as.numeric(STD_RP$MM + 1.0078)
RTS <- as.numeric(STD_RP$RT)
lo <- RTS
RT.est <- RT.est <- predict(shrts, newdata = data.frame(lo), interval = c("confidence"), level = 0.95)
RTS <- as.numeric(RT.est[,1])
nam <- db.comp.assign(mz = as.numeric(peakTable$mz),rt = as.numeric(peakTable$rt),
comp_name_db = STD_RP$compound, mz_db = mzs, rt_db = RTS, mzabs=0.01,ppm=20,ret_tol=1.5)
peakTable <- cbind(nam, peakTable)
sicuri <- intersect(peakTable$nam, peakTable$compound)
write.csv(peakTable, file="peakTable.csv")
load("H:/progetto Garniga/risultati/Essudato analisi R/eesudato_RPneg.Rdata")
peakTable <- metaMS.set$PeakTable
write.csv(peakTable, file="peakTable.csv")
use_data_raw()
library("devtools", lib.loc="C:/Program Files/R/R-3.3.0/library")
use_data_raw()ù
use_data_raw()
use_data(peakTable)
use_data(peakTable, overwrite=TRUE)
data(peakTable)
use_data(peakTable, overwrite=TRUE, compress = "xz")
data(peakTable)
peakTable
showMethods("peakTable")
load("H:/progetto Garniga/risultati/Essudato analisi R/eesudato_RPneg.Rdata")
peakTable <- metaMS.set$PeakTable
use_data(peakTable, overwrite=TRUE, compress = "xz")
data(peakTable)
require(chemhelper)
require(stringr)
ord <- order(peakTable$mz)
peakTable <- peakTable[ord,]
row.names(peakTable) <- 1: nrow(peakTable)
STD_RP <- read.csv("H:/R/STD_RP.csv", stringsAsFactors=FALSE)
load("H:/R/R stuff/short_rts.Rdata")
mzs <- as.numeric(STD_RP$MM + 1.0078)
RTS <- as.numeric(STD_RP$RT)
lo <- RTS
RT.est <- RT.est <- predict(shrts, newdata = data.frame(lo), interval = c("confidence"), level = 0.95)
RTS <- as.numeric(RT.est[,1])
nam <- db.comp.assign(mz = as.numeric(peakTable$mz),rt = as.numeric(peakTable$rt),
comp_name_db = STD_RP$compound, mz_db = mzs, rt_db = RTS, mzabs=0.01,ppm=20,ret_tol=1.5)
peakTable <- cbind(nam, peakTable)
sicuri <- intersect(peakTable$nam, peakTable$compound)
sicuri
write.csv(sicuri, file="sicuri.csv")
write.csv(peakTable, file="peakTable.csv")
candidates <- reorder.csv(H:/R/CCC/CCC_method/inst/extdata, tni)
candidates <- reorder.csv("H:/R/CCC/CCC_method/inst/extdata", tni)
library("CCC", lib.loc="C:/Program Files/R/R-3.3.0/library")
candidates <- reorder.csv("H:/R/CCC/CCC_method/inst/extdata", tni)
tni <- apply.model(peakTable, polarity = "negative")
candidates <- reorder.csv("H:/R/CCC/CCC_method/inst/extdata", tni)
library("ChemmineOB", lib.loc="C:/Program Files/R/R-3.3.0/library")
detach("package:ChemmineOB", unload=TRUE)
remove.packages("ChemmineOB")
source("https://bioconductor.org/biocLite.R")
biocLite("ChemmineOB")
source("https://bioconductor.org/biocLite.R")
biocLite("ChemmineOB")
data (peakTable)
tni <- apply.model(peakTable, polarity = "negative")
candidates <- reorder.csv("H:/R/CCC/CCC_method/inst/extdata", tni)
library("CCC", lib.loc="C:/Program Files/R/R-3.3.0/library")
data (peakTable)
tni <- apply.model(peakTable, polarity = "negative")
candidates <- reorder.csv("H:/R/CCC/CCC_method/inst/extdata", tni)
candidates
candidates <- reorder.csv("H:/R/CCC/CCC_method/inst/extdata/CSV", tni)
View(candidates)
View(candidates[[1]])
View(candidates[[2]])
ord <- order(peakTable$mz)
peakTable <- peakTable[ord,]
row.names(peakTable) <- 1: nrow(peakTable)
STD_RP <- read.csv("H:/R/STD_RP.csv", stringsAsFactors=FALSE)
load("H:/R/R stuff/short_rts.Rdata")
mzs <- as.numeric(STD_RP$MM - 1.0078)
RTS <- as.numeric(STD_RP$RT)
lo <- RTS
RT.est <- RT.est <- predict(shrts, newdata = data.frame(lo), interval = c("confidence"), level = 0.95)
RTS <- as.numeric(RT.est[,1])
nam <- db.comp.assign(mz = as.numeric(peakTable$mz),rt = as.numeric(peakTable$rt),
comp_name_db = STD_RP$compound, mz_db = mzs, rt_db = RTS, mzabs=0.01,ppm=20,ret_tol=1.5)
peakTable <- cbind(nam, peakTable)
sicuri <- intersect(peakTable$nam, peakTable$compound)
require(chemhelper)
require(stringr)
nam <- db.comp.assign(mz = as.numeric(peakTable$mz),rt = as.numeric(peakTable$rt),
comp_name_db = STD_RP$compound, mz_db = mzs, rt_db = RTS, mzabs=0.01,ppm=20,ret_tol=1.5)
peakTable <- cbind(nam, peakTable)
sicuri <- intersect(peakTable$nam, peakTable$compound)
write.csv(sicuri, file="sicuri.csv")
write.csv(peakTable, file="peakTable.csv")
data(peakTable)
write.csv(sicuri, file="sicuri.csv")
peakTable <- cbind(nam, peakTable)
ord <- order(peakTable$mz)
peakTable <- peakTable[ord,]
row.names(peakTable) <- 1: nrow(peakTable)
STD_RP <- read.csv("H:/R/STD_RP.csv", stringsAsFactors=FALSE)
load("H:/R/R stuff/short_rts.Rdata")
mzs <- as.numeric(STD_RP$MM - 1.0078)
RTS <- as.numeric(STD_RP$RT)
lo <- RTS
RT.est <- RT.est <- predict(shrts, newdata = data.frame(lo), interval = c("confidence"), level = 0.95)
RTS <- as.numeric(RT.est[,1])
nam <- db.comp.assign(mz = as.numeric(peakTable$mz),rt = as.numeric(peakTable$rt),
comp_name_db = STD_RP$compound, mz_db = mzs, rt_db = RTS, mzabs=0.01,ppm=20,ret_tol=1.5)
peakTable <- cbind(nam, peakTable)
write.csv(peakTable, file="peakTable.csv")
library(CCC)
library("CCC", lib.loc="C:/Program Files/R/R-3.3.0/library")
data(peakTable)
ord <- order(peakTable$mz)
peakTable <- peakTable[ord,]
row.names(peakTable) <- 1: nrow(peakTable)
STD_RP <- read.csv("H:/R/STD_RP.csv", stringsAsFactors=FALSE)
load("H:/R/R stuff/short_rts.Rdata")
mzs <- as.numeric(STD_RP$MM - 1.0078)
RTS <- as.numeric(STD_RP$RT)
lo <- RTS
RT.est <- RT.est <- predict(shrts, newdata = data.frame(lo), interval = c("confidence"), level = 0.95)
RTS <- as.numeric(RT.est[,1])
nam <- db.comp.assign(mz = as.numeric(peakTable$mz),rt = as.numeric(peakTable$rt),
comp_name_db = STD_RP$compound, mz_db = mzs, rt_db = RTS, mzabs=0.01,ppm=20,ret_tol=1.5)
peakTable <- cbind(nam, peakTable)
sicuri <- intersect(peakTable$nam, peakTable$compound)
write.csv(sicuri, file="sicuri.csv")
write.csv(peakTable, file="peakTable.csv")
data(peakTable)
data (peakTable)
tni <- apply.model(peakTable, polarity = "negative")
candidates <- reorder.csv("H:/R/CCC/CCC_method/inst/extdata/CSV", tni)
View(candidates[[1]])
View(candidates[[2]])
View(candidates[[3]])
View(candidates[[4]])
View(tni[[175]])
compi <- do.call(rbind, tni)
View(compi)
candidates[[1]]
View(compi)
library(CCC)
data (peakTable)
tni <- apply.model(peakTable, polarity = "negative")
candidates <- reorder.csv("H:/R/CCC/CCC_method/inst/extdata/SDF", tni)
data (peakTable)
tni <- apply.model(peakTable, polarity = "negative")
candidates <- reorder.csv("H:/R/CCC/CCC_method/inst/extdata/SDF/", tni)
candidates <- reorder.sdf("H:/R/CCC/CCC_method/inst/extdata/SDF/", tni)
candidates[[1]][1]
candidates[[1]]
candidates[[1]][1]@ID
candidates[[1]][1]@SDF
View(compi[2376,])
View(compi)
View(compi[order(compi$rowname),]
)
ord <- order(compi$rowname)
View(compi[order(as.vector(compi$rowname)),])
ord <- order(as.numeric(compi$rowname))
view(compi[ord,])
View(compi[ord,])
setwd("H:/R/CCC/CCC_method")
library(CCC)
library(CCC)
detach("package:CCC", unload=TRUE)
library(CCC)
citation "rrcov"
citation("rrcov")
citation("ppls")
citation ("Rdisop")
?warning
library(CCC)
library(CCC)
library(CCC)
citation("chemhelper")
library(CCC)
